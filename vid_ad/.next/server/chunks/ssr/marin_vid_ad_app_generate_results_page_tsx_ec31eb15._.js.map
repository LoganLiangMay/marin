{"version":3,"sources":["turbopack:///[project]/marin/vid_ad/app/generate/results/page.tsx","turbopack:///[project]/marin/vid_ad/lib/services/replicateVideoService.ts"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport Link from 'next/link';\nimport { ReplicateVideoService } from '@/lib/services/replicateVideoService';\n\ninterface VideoResult {\n  id: string;\n  url: string;\n  thumbnail: string;\n  status: 'generating' | 'completed' | 'failed';\n  progress: number;\n  duration: number;\n  metadata: {\n    productName: string;\n    brandTone: string;\n    orientation: string;\n    resolution: string;\n    prompt?: string;\n    model?: string;\n    cost?: number;\n  };\n}\n\nexport default function GenerateResultsPage() {\n  const router = useRouter();\n  const [videos, setVideos] = useState<VideoResult[]>([]);\n  const [isGenerating, setIsGenerating] = useState(true);\n  const [currentProgress, setCurrentProgress] = useState(0);\n  const [generationPhase, setGenerationPhase] = useState('Initializing Replicate API...');\n  const [generationData, setGenerationData] = useState<any>(null);\n  const replicateService = ReplicateVideoService.getInstance();\n\n  useEffect(() => {\n    // Get campaign ID from URL\n    const searchParams = new URLSearchParams(window.location.search);\n    const campaignId = searchParams.get('campaignId');\n\n    if (!campaignId) {\n      console.error('‚ùå No campaign ID provided');\n      alert('Campaign not found. Please create a new campaign.');\n      router.push('/generate');\n      return;\n    }\n\n    // Get generation parameters from localStorage using campaign ID\n    const campaignKey = `campaign_${campaignId}`;\n    const campaignDataStr = localStorage.getItem(campaignKey);\n\n    if (!campaignDataStr) {\n      console.error('‚ùå Campaign data not found for ID:', campaignId);\n      alert('Campaign data not found. Please create a new campaign.');\n      router.push('/generate');\n      return;\n    }\n\n    try {\n      const parsedData = JSON.parse(campaignDataStr);\n      console.log('üöÄ Starting Replicate video generation with params:', parsedData);\n      console.log('üìã Campaign ID:', campaignId);\n\n      // Store generation data in state for use throughout component\n      setGenerationData(parsedData);\n\n      const variations = parsedData.variations || 2;\n      const duration = parsedData.duration || 6;\n\n      // Generate prompts based on campaign data\n      const generateVideoPrompts = () => {\n        const brandTone = parsedData.brandTone || 'professional';\n        const productName = parsedData.productName;\n        const description = parsedData.productDescription;\n\n        if (!productName) {\n          console.error('‚ùå Product name is required');\n          return [];\n        }\n\n        const prompts = [\n          `${brandTone} cinematic opening: ${productName} displayed prominently. ${description}. Professional lighting, clean composition, high-quality presentation, product-focused establishing shot. Camera: smooth tracking shot, 24fps cinematic`,\n\n          `${brandTone} detail sequence: Close-up highlights of ${productName} features and benefits. ${description}. Dynamic camera movement, smooth transitions, emphasis on quality and craftsmanship. Camera: medium shot with movement, 30fps`,\n\n          `${brandTone} lifestyle moment: ${productName} in real-world usage scenario showing product value. ${description}. Authentic presentation, professional quality, engaging composition. Camera: wide to close-up, 24fps cinematic`\n        ];\n\n        return prompts.slice(0, variations);\n      };\n\n    const initializeVideoGeneration = async () => {\n      const prompts = generateVideoPrompts();\n      const initialVideos: VideoResult[] = [];\n\n      // Phase 1: Initialize videos\n      setGenerationPhase('Connecting to Replicate API...');\n      setCurrentProgress(10);\n\n      for (let i = 0; i < Math.min(variations, prompts.length); i++) {\n        // Map orientation to aspect ratio\n        const orientationToAspectRatio: Record<string, string> = {\n          'portrait': '9:16',\n          'landscape': '16:9',\n          'square': '1:1'\n        };\n\n        const orientation = parsedData.orientation || 'portrait';\n        const replicateParams = {\n          prompt: prompts[i] || `Generate ${parsedData.productName || 'product'} video ad scene ${i + 1}`,\n          duration: duration,\n          aspectRatio: orientationToAspectRatio[orientation] as '16:9' | '4:3' | '1:1' | '3:4' | '9:16' | '21:9' | '9:21',\n          resolution: (parsedData.resolution || '720p') as '480p' | '720p' | '1080p',\n          model: (parsedData.videoModel || 'seedance-1-lite') as 'seedance-1-lite' | 'seedance-1-pro',\n        };\n\n        // Start generation with Replicate service\n        const replicateResult = await replicateService.generateVideo(replicateParams);\n\n        initialVideos.push({\n          id: replicateResult.id,\n          url: '',\n          thumbnail: '',\n          status: 'generating',\n          progress: 0,\n          duration: duration,\n          metadata: {\n            productName: parsedData.productName || 'Product',\n            brandTone: parsedData.brandTone || 'professional',\n            orientation: parsedData.orientation || 'portrait',\n            resolution: parsedData.resolution || '720p',\n            prompt: prompts[i],\n            model: replicateParams.model,\n            cost: replicateResult.metadata.cost,\n          },\n        });\n      }\n\n      setVideos(initialVideos);\n      setGenerationPhase('Video generation started - this may take 10-20 minutes per video...');\n      setCurrentProgress(20);\n\n      // Poll each video individually and update UI as they complete\n      const pollVideo = async (video: VideoResult, index: number) => {\n        try {\n          console.log(`üé¨ Starting to poll video ${index + 1}/${initialVideos.length}`);\n\n          // Wait for this specific video to complete (20 minute timeout)\n          const status = await replicateService.waitForCompletion(video.id, 1200000);\n\n          // Update this specific video in the state\n          setVideos(prevVideos =>\n            prevVideos.map(v =>\n              v.id === video.id\n                ? {\n                    ...v,\n                    url: status.url || '',\n                    thumbnail: status.thumbnail || `https://picsum.photos/seed/${video.id}/400/600`,\n                    status: 'completed' as const,\n                    progress: 100,\n                  }\n                : v\n            )\n          );\n\n          console.log(`‚úÖ Video ${index + 1}/${initialVideos.length} completed`);\n        } catch (error) {\n          console.error(`‚ùå Error generating video ${video.id}:`, error);\n\n          // Mark this video as failed\n          setVideos(prevVideos =>\n            prevVideos.map(v =>\n              v.id === video.id\n                ? {\n                    ...v,\n                    status: 'failed' as const,\n                    progress: 0,\n                  }\n                : v\n            )\n          );\n        }\n      };\n\n      // Start polling all videos in parallel\n      await Promise.allSettled(\n        initialVideos.map((video, index) => pollVideo(video, index))\n      );\n\n      // All videos processed (completed or failed)\n      setGenerationPhase('Video generation complete!');\n      setCurrentProgress(100);\n      setIsGenerating(false);\n    };\n\n      initializeVideoGeneration();\n    } catch (error) {\n      console.error('‚ùå Error initializing campaign:', error);\n      alert('Error loading campaign data. Please try again.');\n      router.push('/generate');\n    }\n  }, [router]);\n\n  const handleDownload = (video: VideoResult) => {\n    window.open(video.url, '_blank');\n  };\n\n  const handleRegenerateVideo = async (index: number) => {\n    const video = videos[index];\n    if (!video) return;\n\n    setVideos(prevVideos =>\n      prevVideos.map((v, i) =>\n        i === index ? { ...v, status: 'generating' as const, progress: 0 } : v\n      )\n    );\n\n    // Map orientation to aspect ratio\n    const orientationToAspectRatio: Record<string, '16:9' | '4:3' | '1:1' | '3:4' | '9:16' | '21:9' | '9:21'> = {\n      'portrait': '9:16',\n      'landscape': '16:9',\n      'square': '1:1'\n    };\n\n    // Regenerate with Replicate service\n    const newParams = {\n      prompt: video.metadata.prompt || `Regenerate ${video.metadata.productName} video scene`,\n      duration: video.duration,\n      aspectRatio: orientationToAspectRatio[video.metadata.orientation] || '16:9',\n      resolution: video.metadata.resolution as '480p' | '720p' | '1080p',\n      model: (video.metadata.model || 'seedance-1-lite') as 'seedance-1-lite' | 'seedance-1-pro',\n    };\n\n    try {\n      const replicateResult = await replicateService.generateVideo(newParams);\n\n      // Wait for completion\n      const status = await replicateService.waitForCompletion(replicateResult.id);\n\n      setVideos(prevVideos =>\n        prevVideos.map((v, i) =>\n          i === index\n            ? {\n                ...v,\n                id: replicateResult.id,\n                status: 'completed' as const,\n                progress: 100,\n                url: status.url || '',\n                thumbnail: status.thumbnail || `https://picsum.photos/seed/${replicateResult.id}/400/600`,\n              }\n            : v\n        )\n      );\n    } catch (error) {\n      console.error('Error regenerating video:', error);\n      setVideos(prevVideos =>\n        prevVideos.map((v, i) =>\n          i === index ? { ...v, status: 'failed' as const } : v\n        )\n      );\n    }\n  };\n\n  const getTotalCost = () => {\n    return videos.reduce((sum, video) => sum + (video.metadata.cost || 0), 0).toFixed(2);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100\">\n      {/* Header */}\n      <nav className=\"bg-white shadow-sm\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between h-16\">\n            <div className=\"flex items-center\">\n              <h1 className=\"text-xl font-semibold text-gray-900\">Replicate Video Generation</h1>\n            </div>\n            <div className=\"flex items-center space-x-4\">\n              <Link\n                href=\"/dashboard\"\n                className=\"text-sm text-gray-500 hover:text-gray-700\"\n              >\n                Back to Dashboard\n              </Link>\n            </div>\n          </div>\n        </div>\n      </nav>\n\n      <main className=\"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8\">\n        {/* Status Banner */}\n        {isGenerating && (\n          <div className=\"mb-6 px-4\">\n            <div className=\"bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg p-6 text-white\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <div>\n                  <h2 className=\"text-2xl font-bold mb-2\">üé¨ Generating with Replicate</h2>\n                  <p className=\"text-lg opacity-90\">{generationPhase}</p>\n                </div>\n                <div className=\"text-right\">\n                  <div className=\"text-3xl font-bold\">{currentProgress}%</div>\n                  <div className=\"text-sm opacity-75\">Complete</div>\n                </div>\n              </div>\n              <div className=\"w-full bg-white/20 rounded-full h-4\">\n                <div\n                  className=\"bg-white h-4 rounded-full transition-all duration-500 flex items-center justify-end pr-2\"\n                  style={{ width: `${currentProgress}%` }}\n                >\n                  {currentProgress > 10 && (\n                    <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-pulse\" />\n                  )}\n                </div>\n              </div>\n              <div className=\"mt-4 grid grid-cols-3 gap-4 text-sm\">\n                <div className=\"bg-white/10 rounded p-2\">\n                  <div className=\"opacity-75\">Model</div>\n                  <div className=\"font-semibold\">Seedance</div>\n                </div>\n                <div className=\"bg-white/10 rounded p-2\">\n                  <div className=\"opacity-75\">Est. Time</div>\n                  <div className=\"font-semibold\">~10 seconds</div>\n                </div>\n                <div className=\"bg-white/10 rounded p-2\">\n                  <div className=\"opacity-75\">Quality</div>\n                  <div className=\"font-semibold\">1080p HD</div>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Video Grid */}\n        <div className=\"px-4\">\n          <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">\n            Generated {generationData?.productName || 'Campaign'} Videos ({videos.length})\n          </h2>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {videos.map((video, index) => (\n              <div\n                key={video.id}\n                className=\"bg-white rounded-lg shadow-md overflow-hidden\"\n              >\n                {/* Video Preview */}\n                <div className=\"aspect-[9/16] relative bg-gray-100\">\n                  {video.status === 'completed' ? (\n                    <>\n                      <video\n                        src={video.url}\n                        poster={video.thumbnail}\n                        controls\n                        className=\"w-full h-full object-cover\"\n                      >\n                        Your browser does not support the video tag.\n                      </video>\n                      <div className=\"absolute top-2 right-2 bg-green-500 text-white px-2 py-1 rounded text-xs flex items-center gap-1\">\n                        <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                          <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\n                        </svg>\n                        Replicate AI\n                      </div>\n                    </>\n                  ) : (\n                    <div className=\"flex items-center justify-center h-full\">\n                      <div className=\"text-center\">\n                        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"></div>\n                        <p className=\"mt-2 text-sm text-gray-600\">Generating with Replicate...</p>\n                        <p className=\"text-xs text-gray-500\">{video.progress}%</p>\n                      </div>\n                    </div>\n                  )}\n                </div>\n\n                {/* Video Info */}\n                <div className=\"p-4\">\n                  <h3 className=\"font-semibold text-gray-900\">\n                    Scene {index + 1}: {index === 0 ? 'Opening' : index === 1 ? 'Action' : 'Finale'}\n                  </h3>\n                  <div className=\"mt-2 space-y-1 text-sm text-gray-600\">\n                    <p className=\"line-clamp-2 text-xs\">{video.metadata.prompt}</p>\n                    <div className=\"flex items-center gap-2 mt-2\">\n                      <span className=\"bg-gray-100 px-2 py-1 rounded text-xs\">{video.metadata.model}</span>\n                      <span className=\"bg-gray-100 px-2 py-1 rounded text-xs\">{video.metadata.resolution}</span>\n                      <span className=\"bg-gray-100 px-2 py-1 rounded text-xs\">{video.duration}s</span>\n                    </div>\n                    {video.metadata.cost && (\n                      <p className=\"text-green-600 font-semibold\">${video.metadata.cost}</p>\n                    )}\n                  </div>\n\n                  {/* Actions */}\n                  <div className=\"mt-4 flex space-x-2\">\n                    {video.status === 'completed' && (\n                      <>\n                        <button\n                          onClick={() => handleDownload(video)}\n                          className=\"flex-1 bg-blue-600 text-white px-3 py-2 rounded-md text-sm hover:bg-blue-700\"\n                        >\n                          Download\n                        </button>\n                        <button\n                          onClick={() => handleRegenerateVideo(index)}\n                          className=\"flex-1 bg-gray-100 text-gray-700 px-3 py-2 rounded-md text-sm hover:bg-gray-200\"\n                        >\n                          Regenerate\n                        </button>\n                      </>\n                    )}\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {/* Generation Summary */}\n        {!isGenerating && videos.length > 0 && (\n          <div className=\"mt-8 px-4\">\n            <div className=\"bg-white rounded-lg shadow-md p-6\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\n                Video Generation Complete ‚ú®\n              </h3>\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\">\n                <div>\n                  <p className=\"text-gray-500\">Total Videos</p>\n                  <p className=\"font-semibold text-lg\">{videos.length}</p>\n                </div>\n                <div>\n                  <p className=\"text-gray-500\">Generation Time</p>\n                  <p className=\"font-semibold text-lg\">10 seconds</p>\n                </div>\n                <div>\n                  <p className=\"text-gray-500\">Total Cost</p>\n                  <p className=\"font-semibold text-lg text-green-600\">${getTotalCost()}</p>\n                </div>\n                <div>\n                  <p className=\"text-gray-500\">Quality</p>\n                  <p className=\"font-semibold text-lg\">1080p HD</p>\n                </div>\n              </div>\n\n              <div className=\"mt-6 p-4 bg-blue-50 rounded-lg\">\n                <h4 className=\"font-semibold text-blue-900 mb-2\">\n                  üéØ {generationData?.productName || 'Campaign'} Ready\n                </h4>\n                <p className=\"text-sm text-blue-700\">\n                  Your {generationData?.brandTone || 'professional'} {generationData?.productName || 'campaign'} videos have been generated using Replicate's Seedance model.\n                  Each scene was crafted according to your specifications with high-quality output,\n                  professional editing, and dynamic presentation as requested.\n                </p>\n              </div>\n\n              <div className=\"mt-6 flex space-x-4\">\n                <button\n                  onClick={() => router.push('/generate?new=true')}\n                  className=\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700\"\n                >\n                  Generate New Campaign\n                </button>\n                <button\n                  onClick={() => router.push('/dashboard')}\n                  className=\"bg-gray-100 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-200\"\n                >\n                  Back to Dashboard\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n      </main>\n    </div>\n  );\n}","import { getFunctions, httpsCallable } from 'firebase/functions';\nimport { app } from '@/lib/firebase/config';\n\ninterface ReplicateVideoParams {\n  prompt: string;\n  duration?: number; // 2-12 seconds\n  resolution?: '480p' | '720p' | '1080p';\n  aspectRatio?: '16:9' | '4:3' | '1:1' | '3:4' | '9:16' | '21:9' | '9:21';\n  model?: 'seedance-1-lite' | 'seedance-1-pro';\n  seed?: number;\n  cameraFixed?: boolean;\n  image?: string; // URL or file for image-to-video\n  lastFrameImage?: string;\n  // Additional form data\n  productName?: string;\n  productDescription?: string;\n  keywords?: string[];\n  brandTone?: string;\n  primaryColor?: string;\n  callToAction?: string;\n  targetAudience?: string;\n}\n\nexport interface VideoGenerationResponse {\n  id: string;\n  status: 'starting' | 'processing' | 'succeeded' | 'failed' | 'canceled';\n  output?: string | string[];\n  error?: any;\n  logs?: string;\n  metrics?: {\n    predict_time?: number;\n  };\n  urls?: {\n    get: string;\n    cancel: string;\n  };\n}\n\ninterface VideoResult {\n  id: string;\n  url: string;\n  thumbnail: string;\n  duration: number;\n  status: 'pending' | 'processing' | 'completed' | 'failed';\n  progress: number;\n  metadata: {\n    prompt: string;\n    model: string;\n    resolution: string;\n    aspectRatio: string;\n    cost: number;\n    generationTime: number;\n  };\n}\n\nexport class ReplicateVideoService {\n  private static instance: ReplicateVideoService;\n  private functions;\n\n  // Model versions - update these if needed\n  private readonly MODELS = {\n    'seedance-1-lite': 'bytedance/seedance-1-lite',\n    'seedance-1-pro': 'bytedance/seedance-1-pro',\n  };\n\n  // Pricing per second (in USD)\n  private readonly PRICING = {\n    'seedance-1-lite': {\n      '480p': 0.018,\n      '720p': 0.036,\n      '1080p': 0.072,\n    },\n    'seedance-1-pro': {\n      '480p': 0.03,\n      '720p': 0.06,\n      '1080p': 0.15,\n    },\n  };\n\n  private constructor() {\n    // Initialize Firebase Functions\n    this.functions = getFunctions(app);\n    console.log('‚úÖ Firebase Functions initialized for Replicate video service');\n  }\n\n  static getInstance(): ReplicateVideoService {\n    if (!ReplicateVideoService.instance) {\n      ReplicateVideoService.instance = new ReplicateVideoService();\n    }\n    return ReplicateVideoService.instance;\n  }\n\n  /**\n   * Generate a video using Replicate's video models (via Firebase Functions)\n   */\n  async generateVideo(params: ReplicateVideoParams): Promise<VideoResult> {\n    console.log('üé¨ Replicate Video Generation Request:', params);\n\n    const model = params.model || 'seedance-1-lite';\n    const duration = params.duration || 6;\n    const resolution = params.resolution || '720p';\n    const aspectRatio = params.aspectRatio || '16:9';\n\n    try {\n      // Call Firebase Function instead of Replicate API directly\n      const generateVideoFn = httpsCallable(this.functions, 'generateReplicateVideo');\n\n      const result = await generateVideoFn({\n        model,\n        prompt: params.prompt,\n        duration,\n        aspectRatio,\n        resolution,\n        seed: params.seed,\n        cameraFixed: params.cameraFixed,\n        image: params.image,\n        lastFrameImage: params.lastFrameImage,\n        productName: params.productName,\n        productDescription: params.productDescription,\n        keywords: params.keywords,\n        brandTone: params.brandTone,\n        primaryColor: params.primaryColor,\n        callToAction: params.callToAction,\n        targetAudience: params.targetAudience,\n      });\n\n      const data = result.data as any;\n\n      console.log('‚úÖ Video generation initiated:', data.predictionId);\n\n      // Calculate estimated cost\n      const cost = this.calculateCost(model, duration, resolution);\n\n      // Return initial result\n      return {\n        id: data.predictionId,\n        url: '',\n        thumbnail: '',\n        duration: duration,\n        status: this.mapStatus(data.status || 'starting'),\n        progress: 0,\n        metadata: {\n          prompt: params.prompt,\n          model: model,\n          resolution: resolution,\n          aspectRatio: aspectRatio,\n          cost: cost,\n          generationTime: 0,\n        },\n      };\n\n    } catch (error: any) {\n      console.error('‚ùå Firebase Function Error:', error);\n\n      if (error.message?.includes('unauthenticated')) {\n        throw new Error('You must be logged in to generate videos.');\n      }\n\n      if (error.message?.includes('resource-exhausted')) {\n        throw new Error('Insufficient credits. Please purchase more credits to continue.');\n      }\n\n      throw new Error(error.message || 'Failed to start video generation');\n    }\n  }\n\n  /**\n   * Check the status of a video generation (via Firebase Functions)\n   */\n  async getVideoStatus(predictionId: string, videoId?: string): Promise<VideoResult> {\n    try {\n      const checkStatusFn = httpsCallable(this.functions, 'checkReplicateVideoStatus');\n\n      const result = await checkStatusFn({\n        predictionId,\n        videoId,\n      });\n\n      const data = result.data as any;\n\n      console.log(`üìä Video status for ${predictionId}:`, data.status);\n\n      // Extract video URL from output\n      let videoUrl = '';\n      if (data.output) {\n        if (typeof data.output === 'string') {\n          videoUrl = data.output;\n        } else if (Array.isArray(data.output) && data.output.length > 0) {\n          videoUrl = data.output[0];\n        }\n      }\n\n      // Calculate progress based on status\n      let progress = 0;\n      if (data.status === 'starting') progress = 10;\n      else if (data.status === 'processing') progress = 50;\n      else if (data.status === 'succeeded') progress = 100;\n      else if (data.status === 'failed') progress = 0;\n\n      return {\n        id: predictionId,\n        url: videoUrl,\n        thumbnail: videoUrl ? this.generateThumbnail(videoUrl) : '',\n        duration: 0, // Duration from metadata if available\n        status: this.mapStatus(data.status),\n        progress: progress,\n        metadata: {\n          prompt: '',\n          model: '',\n          resolution: '',\n          aspectRatio: '',\n          cost: 0,\n          generationTime: data.metrics?.predict_time || 0,\n        },\n      };\n\n    } catch (error: any) {\n      console.error('Error retrieving video status:', error.message);\n      throw error;\n    }\n  }\n\n  /**\n   * Wait for video generation to complete\n   * Default timeout increased to 20 minutes for Replicate video generation\n   */\n  async waitForCompletion(predictionId: string, maxWaitTime: number = 1200000): Promise<VideoResult> {\n    const startTime = Date.now();\n    const pollInterval = 3000; // Check every 3 seconds\n\n    console.log(`‚è≥ Waiting for video ${predictionId} (max ${maxWaitTime / 1000}s)`);\n\n    while (Date.now() - startTime < maxWaitTime) {\n      const result = await this.getVideoStatus(predictionId);\n\n      if (result.status === 'completed') {\n        console.log('‚úÖ Video generation completed:', predictionId);\n        return result;\n      }\n\n      if (result.status === 'failed') {\n        console.error('‚ùå Video generation failed:', predictionId);\n        throw new Error('Video generation failed');\n      }\n\n      // Log progress every 30 seconds\n      const elapsed = Date.now() - startTime;\n      if (elapsed % 30000 < pollInterval) {\n        console.log(`‚è±Ô∏è Video ${predictionId} still processing... (${Math.round(elapsed / 1000)}s elapsed)`);\n      }\n\n      // Wait before polling again\n      await new Promise(resolve => setTimeout(resolve, pollInterval));\n    }\n\n    console.error('‚è±Ô∏è Video generation timed out after', maxWaitTime / 1000, 'seconds');\n    throw new Error(`Video generation timed out after ${maxWaitTime / 1000} seconds`);\n  }\n\n  /**\n   * Cancel a video generation (via Firebase Functions)\n   */\n  async cancelGeneration(predictionId: string, videoId?: string): Promise<void> {\n    try {\n      const cancelFn = httpsCallable(this.functions, 'cancelReplicateVideo');\n\n      await cancelFn({\n        predictionId,\n        videoId,\n      });\n\n      console.log(`Video generation ${predictionId} canceled`);\n    } catch (error: any) {\n      console.error('Error canceling generation:', error.message);\n      throw error;\n    }\n  }\n\n  /**\n   * Calculate cost estimate based on model and parameters\n   */\n  calculateCost(model: string, duration: number, resolution: string): number {\n    const modelKey = model as keyof typeof this.PRICING;\n    const resolutionKey = resolution as keyof typeof this.PRICING['seedance-1-lite'];\n\n    if (!this.PRICING[modelKey] || !this.PRICING[modelKey][resolutionKey]) {\n      console.warn(`No pricing data for ${model} at ${resolution}`);\n      return 0;\n    }\n\n    const pricePerSecond = this.PRICING[modelKey][resolutionKey];\n    return parseFloat((pricePerSecond * duration).toFixed(2));\n  }\n\n  /**\n   * Map Replicate status to our status format\n   */\n  private mapStatus(replicateStatus: string): 'pending' | 'processing' | 'completed' | 'failed' {\n    switch (replicateStatus) {\n      case 'starting':\n        return 'pending';\n      case 'processing':\n        return 'processing';\n      case 'succeeded':\n        return 'completed';\n      case 'failed':\n      case 'canceled':\n        return 'failed';\n      default:\n        return 'pending';\n    }\n  }\n\n  /**\n   * Generate a thumbnail URL from video URL\n   * This is a placeholder - in production you might want to extract actual frames\n   */\n  private generateThumbnail(_videoUrl: string): string {\n    // For now, return a placeholder or the video URL itself\n    // In production, you might want to:\n    // 1. Extract first frame using FFmpeg\n    // 2. Use a thumbnail service\n    // 3. Generate via Replicate's image models\n    return `https://picsum.photos/seed/${Date.now()}/800/450`;\n  }\n\n  /**\n   * Generate multiple video variations from different prompts\n   */\n  async generateVariations(\n    baseParams: ReplicateVideoParams,\n    prompts: string[]\n  ): Promise<VideoResult[]> {\n    const variations: VideoResult[] = [];\n\n    for (const prompt of prompts) {\n      const params = {\n        ...baseParams,\n        prompt: prompt,\n      };\n\n      const result = await this.generateVideo(params);\n      variations.push(result);\n    }\n\n    return variations;\n  }\n\n  /**\n   * Get pricing information for display\n   */\n  getPricingInfo() {\n    return {\n      models: Object.keys(this.MODELS),\n      pricing: this.PRICING,\n      description: {\n        'seedance-1-lite': 'Budget-friendly option, good for drafts and previews',\n        'seedance-1-pro': 'Higher quality with better dynamic range and realism',\n      },\n    };\n  }\n\n  /**\n   * Validate parameters before generation\n   */\n  validateParams(params: ReplicateVideoParams): { valid: boolean; errors: string[] } {\n    const errors: string[] = [];\n\n    if (!params.prompt || params.prompt.trim().length === 0) {\n      errors.push('Prompt is required');\n    }\n\n    if (params.duration && (params.duration < 2 || params.duration > 12)) {\n      errors.push('Duration must be between 2 and 12 seconds');\n    }\n\n    if (params.resolution && !['480p', '720p', '1080p'].includes(params.resolution)) {\n      errors.push('Resolution must be 480p, 720p, or 1080p');\n    }\n\n    if (params.aspectRatio && !['16:9', '4:3', '1:1', '3:4', '9:16', '21:9', '9:21'].includes(params.aspectRatio)) {\n      errors.push('Invalid aspect ratio');\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n    };\n  }\n}\n\nexport default ReplicateVideoService;\n"],"names":[],"mappings":"uDAEA,EAAA,EAAA,CAAA,CAAA,MACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OCJA,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MAsDO,OAAM,EACX,OAAe,QAAgC,CACvC,SAAU,CAGD,OAAS,CACxB,kBAAmB,4BACnB,iBAAkB,0BACpB,CAAE,CAGe,QAAU,CACzB,kBAAmB,CACjB,OAAQ,KACR,OAAQ,KACR,QAAS,IACX,EACA,iBAAkB,CAChB,OAAQ,IACR,OAAQ,IACR,QAAS,GACX,CACF,CAAE,AAEF,cAAsB,CAEpB,IAAI,CAAC,SAAS,CAAG,CAAA,EAAA,EAAA,YAAA,AAAY,EAAC,EAAA,GAAG,EACjC,QAAQ,GAAG,CAAC,+DACd,CAEA,OAAO,aAAqC,CAI1C,OAHI,AAAC,EAAsB,QAAQ,EAAE,CACnC,EAAsB,QAAQ,CAAG,IAAI,CAAA,EAEhC,EAAsB,QAAQ,AACvC,CAKA,MAAM,cAAc,CAA4B,CAAwB,CACtE,QAAQ,GAAG,CAAC,yCAA0C,GAEtD,IAAM,EAAQ,EAAO,KAAK,EAAI,kBACxB,EAAW,EAAO,QAAQ,EAAI,EAC9B,EAAa,EAAO,UAAU,EAAI,OAClC,EAAc,EAAO,WAAW,EAAI,OAE1C,GAAI,CAEF,IAAM,EAAkB,CAAA,EAAA,EAAA,aAAA,AAAa,EAAC,IAAI,CAAC,SAAS,CAAE,0BAqBhD,EAAO,CAnBE,MAAM,EAAgB,OACnC,EACA,OAAQ,EAAO,MAAM,UACrB,cACA,aACA,EACA,KAAM,EAAO,IAAI,CACjB,YAAa,EAAO,WAAW,CAC/B,MAAO,EAAO,KAAK,CACnB,eAAgB,EAAO,cAAc,CACrC,YAAa,EAAO,WAAW,CAC/B,mBAAoB,EAAO,kBAAkB,CAC7C,SAAU,EAAO,QAAQ,CACzB,UAAW,EAAO,SAAS,CAC3B,aAAc,EAAO,YAAY,CACjC,aAAc,EAAO,YAAY,CACjC,eAAgB,EAAO,cAAc,AACvC,EAAA,EAEoB,IAAI,CAExB,QAAQ,GAAG,CAAC,gCAAiC,EAAK,YAAY,EAG9D,IAAM,EAAO,IAAI,CAAC,aAAa,CAAC,EAAO,EAAU,GAGjD,MAAO,CACL,GAAI,EAAK,YAAY,CACrB,IAAK,GACL,UAAW,GACX,SAAU,EACV,OAAQ,IAAI,CAAC,SAAS,CAAC,EAAK,MAAM,EAAI,YACtC,SAAU,EACV,SAAU,CACR,OAAQ,EAAO,MAAM,CACrB,MAAO,EACP,WAAY,EACZ,YAAa,EACb,KAAM,EACN,eAAgB,CAClB,CACF,CAEF,CAAE,MAAO,EAAY,CAGnB,GAFA,QAAQ,KAAK,CAAC,6BAA8B,GAExC,EAAM,OAAO,EAAE,SAAS,mBAC1B,CAD8C,KACxC,AAAI,MAAM,6CAGlB,GAAI,EAAM,OAAO,EAAE,SAAS,sBAC1B,CADiD,KAC3C,AAAI,MAAM,kEAGlB,OAAM,AAAI,MAAM,EAAM,OAAO,EAAI,mCACnC,CACF,CAKA,MAAM,eAAe,CAAoB,CAAE,CAAgB,CAAwB,CACjF,GAAI,CACF,IAAM,EAAgB,CAAA,EAAA,EAAA,aAAA,AAAa,EAAC,IAAI,CAAC,SAAS,CAAE,6BAO9C,EAAO,CALE,MAAM,EAAc,cACjC,UACA,CACF,EAAA,EAEoB,IAAI,CAExB,QAAQ,GAAG,CAAC,CAAC,oBAAoB,EAAE,EAAa,CAAC,CAAC,CAAE,EAAK,MAAM,EAG/D,IAAI,EAAW,GACX,EAAK,MAAM,EAAE,CACY,UAAvB,AAAiC,OAA1B,EAAK,MAAM,CACpB,EAAW,EAAK,MAAM,CACb,MAAM,OAAO,CAAC,EAAK,MAAM,GAAK,EAAK,MAAM,CAAC,MAAM,CAAG,GAAG,CAC/D,EAAW,EAAK,MAAM,CAAC,EAAA,AAAE,GAK7B,IAAI,EAAW,EAMf,MALoB,aAAhB,EAAK,MAAM,CAAiB,EAAW,GAClB,eAAhB,EAAK,MAAM,CAAmB,EAAW,GACzB,cAAhB,EAAK,MAAM,CAAkB,EAAW,IACxB,WAAhB,EAAK,MAAM,GAAe,GAAW,EAEvC,CACL,GAAI,EACJ,IAAK,EACL,UAAW,EAAW,IAAI,CAAC,iBAAiB,CAAC,GAAY,GACzD,SAAU,EACV,OAAQ,IAAI,CAAC,SAAS,CAAC,EAAK,MAAM,EAClC,SAAU,EACV,SAAU,CACR,OAAQ,GACR,MAAO,GACP,WAAY,GACZ,YAAa,GACb,KAAM,EACN,eAAgB,EAAK,OAAO,EAAE,cAAgB,CAChD,CACF,CAEF,CAAE,MAAO,EAAY,CAEnB,MADA,QAAQ,KAAK,CAAC,iCAAkC,EAAM,OAAO,EACvD,CACR,CACF,CAMA,MAAM,kBAAkB,CAAoB,CAAE,EAAsB,IAAO,CAAwB,CACjG,IAAM,EAAY,KAAK,GAAG,GAK1B,IAFA,QAAQ,GAAG,CAAC,CAAC,oBAAoB,EAAE,EAAa,MAAM,EAAE,EAAc,IAAK,EAAE,CAAC,EAEvE,KAAK,GAAG,GAAK,EAAY,GAAa,CAC3C,IAAM,EAAS,MAAM,IAAI,CAAC,cAAc,CAAC,GAEzC,GAAsB,aAAa,CAA/B,EAAO,MAAM,CAEf,OADA,QAAQ,GAAG,CAAC,gCAAiC,GACtC,EAGT,GAAI,AAAkB,UAAU,GAArB,MAAM,CAEf,MADA,QAAQ,KAAK,CAAC,6BAA8B,GACtC,AAAI,MAAM,2BAIlB,IAAM,EAAU,KAAK,GAAG,GAAK,CACzB,GAAU,QAAQ,CACpB,QAAQ,GAAG,CAAC,CAAC,AADqB,SACZ,EAAE,EAAa,sBAAsB,EAAE,KAAK,KAAK,CAAC,EAAU,KAAM,UAAU,CAAC,EAIrG,MAAM,IAAI,QAAQ,GAAW,WAAW,EAxBrB,KAyBrB,CAGA,AA5B2B,CAwBwB,KAGnD,QAAQ,KAAK,CAAC,IA3BqC,kCA2BE,EAAc,IAAM,WACnE,AAAI,MAAM,CAAC,iCAAiC,EAAE,EAAc,IAAK,QAAQ,CAAC,CAClF,CAKA,MAAM,iBAAiB,CAAoB,CAAE,CAAgB,CAAiB,CAC5E,GAAI,CACF,IAAM,EAAW,CAAA,EAAA,EAAA,aAAa,AAAb,EAAc,IAAI,CAAC,SAAS,CAAE,uBAE/C,OAAM,EAAS,cACb,UACA,CACF,GAEA,QAAQ,GAAG,CAAC,CAAC,iBAAiB,EAAE,EAAa,SAAS,CAAC,CACzD,CAAE,MAAO,EAAY,CAEnB,MADA,QAAQ,KAAK,CAAC,8BAA+B,EAAM,OAAO,EACpD,CACR,CACF,CAKA,cAAc,CAAa,CAAE,CAAgB,CAAE,CAAkB,CAAU,QAIpE,AAAL,AAAI,IAAK,CAAC,OAAO,CAAC,EAAS,EAAK,EAAD,EAAK,CAAC,OAAO,CAAC,EAAS,CAAC,AAFjC,EAE+C,CAM9D,CANgE,UAMrD,CADK,AACJ,IADQ,CAAC,OAAO,CARlB,AAQmB,EAAS,CAAC,EAAc,CACxB,CAAA,CAAQ,CAAE,OAAO,CAAC,KALpD,QAAQ,IAAI,CAAC,CAAC,oBAAoB,EAAE,EAAM,IAAI,EAAE,EAAA,CAAY,EACrD,EAKX,CAKQ,UAAU,CAAuB,CAAqD,CAC5F,OAAQ,GACN,IAAK,WASL,QARE,MAAO,SACT,KAAK,aACH,MAAO,YACT,KAAK,YACH,MAAO,WACT,KAAK,SACL,IAAK,WACH,MAAO,QAGX,CACF,CAMQ,kBAAkB,CAAiB,CAAU,CAMnD,MAAO,CAAC,2BAA2B,EAAE,KAAK,GAAG,GAAG,QAAQ,CAAC,AAC3D,CAKA,MAAM,mBACJ,CAAgC,CAChC,CAAiB,CACO,CACxB,IAAM,EAA4B,EAAE,CAEpC,IAAK,IAAM,KAAU,EAAS,CAC5B,IAAM,EAAS,CACb,GAAG,CAAU,CACb,OAAQ,CACV,EAEM,EAAS,MAAM,IAAI,CAAC,aAAa,CAAC,GACxC,EAAW,IAAI,CAAC,EAClB,CAEA,OAAO,CACT,CAKA,gBAAiB,CACf,MAAO,CACL,OAAQ,OAAO,IAAI,CAAC,IAAI,CAAC,MAAM,EAC/B,QAAS,IAAI,CAAC,OAAO,CACrB,YAAa,CACX,kBAAmB,uDACnB,iBAAkB,sDACpB,CACF,CACF,CAKA,eAAe,CAA4B,CAAwC,CACjF,IAAM,EAAmB,EAAE,CAkB3B,OAhBK,AAAD,EAAQ,MAAM,EAAoC,GAAG,CAAnC,EAAO,MAAM,CAAC,IAAI,GAAG,MAAM,EAC/C,EAAO,IAAI,CAAC,sBAGV,EAAO,QAAQ,EAAK,EAAD,CAAQ,QAAQ,CAAG,GAAK,EAAO,QAAQ,CAAG,EAAA,CAAE,EACjE,CADoE,CAC7D,IAAI,CAAC,6CAGV,EAAO,UAAU,EAAI,CAAC,CAAC,OAAQ,OAAQ,QAAQ,CAAC,QAAQ,CAAC,EAAO,UAAU,GAAG,AAC/E,EAAO,IAAI,CAAC,2CAGV,EAAO,WAAW,EAAI,CAAC,CAAC,OAAQ,MAAO,MAAO,MAAO,OAAQ,OAAQ,OAAO,CAAC,QAAQ,CAAC,EAAO,WAAW,GAAG,AAC7G,EAAO,IAAI,CAAC,wBAGP,CACL,MAAyB,IAAlB,EAAO,MAAM,QACpB,CACF,CACF,CACF,CD5We,SAAS,IACtB,IAAM,EAAS,CAAA,EAAA,EAAA,SAAS,AAAT,IACT,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,EAAE,EAChD,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC3C,CAAC,EAAiB,EAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GACjD,CAAC,EAAiB,EAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,iCACjD,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAM,MACpD,EAAmB,EAAsB,WAAW,GAE1D,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KAGR,IAAM,EAAa,AADE,IAAI,gBAAgB,OAAO,QAAQ,CAAC,MAAM,EAC/B,GAAG,CAAC,cAEpC,GAAI,CAAC,EAAY,CACf,QAAQ,KAAK,CAAC,6BACd,MAAM,qDACN,EAAO,IAAI,CAAC,aACZ,MACF,CAGA,IAAM,EAAc,CAAC,SAAS,EAAE,EAAA,CAAY,CACtC,EAAkB,aAAa,OAAO,CAAC,GAE7C,GAAI,CAAC,EAAiB,CACpB,QAAQ,KAAK,CAAC,oCAAqC,GACnD,MAAM,0DACN,EAAO,IAAI,CAAC,aACZ,MACF,CAEA,GAAI,CACF,IAAM,EAAa,KAAK,KAAK,CAAC,GAC9B,QAAQ,GAAG,CAAC,sDAAuD,GACnE,QAAQ,GAAG,CAAC,kBAAmB,GAG/B,EAAkB,GAElB,IAAM,EAAa,EAAW,UAAU,EAAI,EACtC,EAAW,EAAW,QAAQ,EAAI,EAgIxC,CAxGgC,UAChC,IArBQ,EACA,IAoBF,KArBc,EAAW,GAqBf,MArBwB,EAAI,iBACtB,EAAW,WAAW,CACpC,EAAc,EAAW,kBAAkB,CAEjD,AAAK,EAKW,AAQT,CAPL,CANE,AAMF,EAAG,EAAU,KANG,eAMiB,EAAE,EAAY,wBAAwB,EAAE,EAAY,uJAAuJ,CAAC,CAE7O,CAAA,EAAG,EAAU,yCAAyC,EAAE,EAAY,wBAAwB,EAAE,EAAY,8HAA8H,CAAC,CAEzO,CAAA,EAAG,EAAU,mBAAmB,EAAE,EAAY,qDAAqD,EAAE,EAAY,+GAA+G,CAAC,CAClO,CAEc,KAAK,CAAC,EAAG,IAZtB,QAAQ,KAAK,CAAC,8BACP,EAAE,GAgBP,EAA+B,EAAE,CAGvC,EAAmB,kCACnB,EAAmB,IAEnB,IAAK,IAAI,EAAI,EAAG,EAAI,KAAK,GAAG,CAAC,EAAY,EAAQ,MAAM,EAAG,IAAK,CAE7D,IAAM,EAAmD,CACvD,SAAY,OACZ,UAAa,OACb,OAAU,KACZ,EAEM,EAAc,EAAW,WAAW,EAAI,WACxC,EAAkB,CACtB,OAAQ,CAAO,CAAC,EAAE,EAAI,CAAC,SAAS,EAAE,EAAW,WAAW,EAAI,UAAU,gBAAgB,EAAE,EAAI,EAAA,CAAG,CAC/F,SAAU,EACV,YAAa,CAAwB,CAAC,EAAY,CAClD,WAAa,EAAW,UAAU,EAAI,OACtC,MAAQ,EAAW,UAAU,EAAI,iBACnC,EAGM,EAAkB,MAAM,EAAiB,aAAa,CAAC,GAE7D,EAAc,IAAI,CAAC,CACjB,GAAI,EAAgB,EAAE,CACtB,IAAK,GACL,UAAW,GACX,OAAQ,aACR,SAAU,EACV,SAAU,EACV,SAAU,CACR,YAAa,EAAW,WAAW,EAAI,UACvC,UAAW,EAAW,SAAS,EAAI,eACnC,YAAa,EAAW,WAAW,EAAI,WACvC,WAAY,EAAW,UAAU,EAAI,OACrC,OAAQ,CAAO,CAAC,EAAE,CAClB,MAAO,EAAgB,KAAK,CAC5B,KAAM,EAAgB,QAAQ,CAAC,IAAI,AACrC,CACF,EACF,CAEA,EAAU,GACV,EAAmB,uEACnB,EAAmB,IAGnB,IAAM,EAAY,MAAO,EAAoB,KAC3C,GAAI,CACF,QAAQ,GAAG,CAAC,CAAC,0BAA0B,EAAE,EAAQ,EAAE,CAAC,EAAE,EAAc,MAAM,CAAA,CAAE,EAG5E,IAAM,EAAS,MAAM,EAAiB,iBAAiB,CAAC,EAAM,EAAE,CAAE,MAGlE,EAAU,GACR,EAAW,GAAG,CAAC,GACb,EAAE,EAAE,GAAK,EAAM,EAAE,CACb,CACE,GAAG,CAAC,CACJ,IAAK,EAAO,GAAG,EAAI,GACnB,UAAW,EAAO,SAAS,EAAI,CAAC,2BAA2B,EAAE,EAAM,EAAE,CAAC,QAAQ,CAAC,CAC/E,OAAQ,YACR,SAAU,GACZ,EACA,IAIR,QAAQ,GAAG,CAAC,CAAC,QAAQ,EAAE,EAAQ,EAAE,CAAC,EAAE,EAAc,MAAM,CAAC,UAAU,CAAC,CACtE,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,CAAC,yBAAyB,EAAE,EAAM,EAAE,CAAC,CAAC,CAAC,CAAE,GAGvD,EAAU,GACR,EAAW,GAAG,CAAC,GACb,EAAE,EAAE,GAAK,EAAM,EAAE,CACb,CACE,GAAG,CAAC,CACJ,OAAQ,SACR,SAAU,CACZ,EACA,GAGV,CACF,CAGA,OAAM,QAAQ,UAAU,CACtB,EAAc,GAAG,CAAC,CAAC,EAAO,IAAU,EAAU,EAAO,KAIvD,EAAmB,8BACnB,EAAmB,KACnB,GAAgB,GAClB,GAGA,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,iCAAkC,GAChD,MAAM,kDACN,EAAO,IAAI,CAAC,YACd,CACF,EAAG,CAAC,EAAO,EAMX,IAAM,EAAwB,MAAO,IACnC,IAAM,EAAQ,CAAM,CAAC,EAAM,CAC3B,GAAI,CAAC,EAAO,OAEZ,EAAU,GACR,EAAW,GAAG,CAAC,CAAC,EAAG,IACjB,IAAM,EAAQ,CAAE,GAAG,CAAC,CAAE,OAAQ,aAAuB,SAAU,CAAE,EAAI,IAYzE,IAAM,EAAY,CAChB,OAAQ,EAAM,QAAQ,CAAC,MAAM,EAAI,CAAC,WAAW,EAAE,EAAM,QAAQ,CAAC,WAAW,CAAC,YAAY,CAAC,CACvF,SAAU,EAAM,QAAQ,CACxB,YAV0G,AAU7F,CATb,SAAY,OACZ,UAAa,OACb,OAAU,KACZ,CAMuC,CAAC,EAAM,QAAQ,CAAC,WAAW,CAAC,EAAI,OACrE,WAAY,EAAM,QAAQ,CAAC,UAAU,CACrC,MAAQ,EAAM,QAAQ,CAAC,KAAK,EAAI,iBAClC,EAEA,GAAI,CACF,IAAM,EAAkB,MAAM,EAAiB,aAAa,CAAC,GAGvD,EAAS,MAAM,EAAiB,iBAAiB,CAAC,EAAgB,EAAE,EAE1E,EAAU,GACR,EAAW,GAAG,CAAC,CAAC,EAAG,IACjB,IAAM,EACF,CACE,GAAG,CAAC,CACJ,GAAI,EAAgB,EAAE,CACtB,OAAQ,YACR,SAAU,IACV,IAAK,EAAO,GAAG,EAAI,GACnB,UAAW,EAAO,SAAS,EAAI,CAAC,2BAA2B,EAAE,EAAgB,EAAE,CAAC,QAAQ,CAAC,AAC3F,EACA,GAGV,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,4BAA6B,GAC3C,EAAU,GACR,EAAW,GAAG,CAAC,CAAC,EAAG,IACjB,IAAM,EAAQ,CAAE,GAAG,CAAC,CAAE,OAAQ,QAAkB,EAAI,GAG1D,CACF,EAMA,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sEAEb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,8BACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6BACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,+CAAsC,iCAEtD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAI,CAAA,CACH,KAAK,aACL,UAAU,qDACX,+BAQT,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,mDAEb,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mFACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,mCAA0B,iCACxC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,8BAAsB,OAErC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,+BAAsB,EAAgB,OACrD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,8BAAqB,mBAGxC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+CACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,UAAU,2FACV,MAAO,CAAE,MAAO,CAAA,EAAG,EAAgB,CAAC,CAAC,AAAC,WAErC,EAAkB,IACjB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAIrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sBAAa,UAC5B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBAAgB,gBAEjC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sBAAa,cAC5B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBAAgB,mBAEjC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sBAAa,YAC5B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBAAgB,wBAQzC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iBACb,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,UAAU,kDAAwC,aACzC,GAAgB,aAAe,WAAW,YAAU,EAAO,MAAM,CAAC,OAG/E,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gEACZ,EAAO,GAAG,CAAC,CAAC,EAAO,IAClB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEC,UAAU,0DAGV,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,8CACK,cAAjB,EAAM,MAAM,CACX,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACE,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,IAAK,EAAM,GAAG,CACd,OAAQ,EAAM,SAAS,CACvB,QAAQ,CAAA,CAAA,EACR,UAAU,sCACX,iDAGD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6GACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,UAAU,KAAK,eAAe,QAAQ,qBACnD,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,SAAS,UAAU,EAAE,qHAAqH,SAAS,cACrJ,qBAKV,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2EACf,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sCAA6B,iCAC1C,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,kCAAyB,EAAM,QAAQ,CAAC,cAO7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gBACb,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,UAAU,wCAA8B,SACnC,EAAQ,EAAE,KAAa,IAAV,EAAc,UAAsB,IAAV,EAAc,SAAW,YAEzE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iDACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,gCAAwB,EAAM,QAAQ,CAAC,MAAM,GAC1D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yCACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,iDAAyC,EAAM,QAAQ,CAAC,KAAK,GAC7E,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,iDAAyC,EAAM,QAAQ,CAAC,UAAU,GAClF,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,kDAAyC,EAAM,QAAQ,CAAC,UAEzE,EAAM,QAAQ,CAAC,IAAI,EAClB,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,yCAA+B,IAAE,EAAM,QAAQ,CAAC,IAAI,OAKrE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+BACK,cAAjB,EAAM,MAAM,EACX,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACE,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,CA/LrC,OAAO,IAAI,CA+LyC,AA/LxC,EAAM,GAAG,CAAE,WAgMD,UAAU,wFACX,aAGD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAsB,GACrC,UAAU,2FACX,yBA/DJ,EAAM,EAAE,QA4EpB,CAAC,GAAgB,EAAO,MAAM,CAAG,GAChC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,oDAA2C,gCAGzD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0DACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yBAAgB,iBAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iCAAyB,EAAO,MAAM,MAErD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yBAAgB,oBAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iCAAwB,kBAEvC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yBAAgB,eAC7B,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,iDAAuC,IAzK3D,EAAO,MAAM,CAAC,CAAC,EAAK,IAAU,EAAO,GAAM,CAAP,OAAe,CAAC,IAAI,GAAI,CAAC,CAAG,GAAG,OAAO,CAAC,SA2KtE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yBAAgB,YAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iCAAwB,mBAIzC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2CACb,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,UAAU,6CAAmC,MAC3C,GAAgB,aAAe,WAAW,YAEhD,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,kCAAwB,QAC7B,GAAgB,WAAa,eAAe,IAAE,GAAgB,aAAe,WAAW,qNAMlG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gCACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAO,IAAI,CAAC,sBAC3B,UAAU,yEACX,0BAGD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAO,IAAI,CAAC,cAC3B,UAAU,4EACX,mCAUjB"}